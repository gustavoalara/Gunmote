<Controls:MetroWindow x:Class="WiiTUIO.NewAppSettingsUC"
                      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                      xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
                      xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
                      xmlns:local="clr-namespace:WiiTUIO"
                      xmlns:Controls="clr-namespace:MahApps.Metro.Controls;assembly=MahApps.Metro" d:DataContext="{d:DesignInstance Type=local:SettingsData}"
                      mc:Ignorable="d" 
                      Title="Configuración de la Aplicación"
                      MinHeight="600" MinWidth="600"
                      Height="800" Width="600"
                      WindowStartupLocation="CenterScreen">
    <Controls:MetroWindow.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <!-- MahApps.Metro resource dictionaries -->
                <ResourceDictionary Source="pack://application:,,,/MahApps.Metro;component/Styles/Colors.xaml" />
                <ResourceDictionary Source="pack://application:,,,/MahApps.Metro;component/Styles/Fonts.xaml" />
                <ResourceDictionary Source="pack://application:,,,/MahApps.Metro;component/Styles/Controls.xaml" />
                <ResourceDictionary Source="pack://application:,,,/MahApps.Metro;component/Styles/Accents/BaseLight.xaml" />
                <ResourceDictionary Source="pack://application:,,,/MahApps.Metro;component/Styles/FlatButton.xaml" />
                <ResourceDictionary Source="/Resources/Icons.xaml" />
            </ResourceDictionary.MergedDictionaries>
        </ResourceDictionary>
    </Controls:MetroWindow.Resources>

    <ScrollViewer VerticalScrollBarVisibility="Auto">
        <StackPanel Margin="10">
            <!-- Back Button - Using a standard MahApps.Metro button style -->
            <Button x:Name="btnAppSettingsBack"  Click="BtnAppSettingsBack_Click" 
                    HorizontalAlignment="Left" Width="40" Height="40" Margin="0,0,0,10"
                    Style="{DynamicResource MetroCircleButtonStyle}">
                <Rectangle Width="14" Height="14" Fill="Black" Opacity="0.8">
                    <Rectangle.OpacityMask>
                        <VisualBrush Visual="{StaticResource appbar_arrow_left}" Stretch="Fill" />
                    </Rectangle.OpacityMask>
                </Rectangle>
            </Button>
            <!-- Example MahApps style -->

            <Label Content="Configuración de la Aplicación" 
                   Style="{DynamicResource MahApps.Metro.Styles.Label}" 
                   FontSize="18" FontWeight="SemiBold" Margin="0,10,0,5"/>

            <!-- General Settings -->
            <GroupBox Header="Configuración General" Margin="0,10,0,0"
                      Style="{DynamicResource MahApps.Metro.Styles.GroupBox}">
                <StackPanel Margin="5">
                    <CheckBox x:Name="cbConnectOnStart" Content="Conectar al iniciar" 
                              IsChecked="{Binding ConnectOnStart}" Checked="Setting_Changed" Unchecked="Setting_Changed"
                              Style="{DynamicResource MahApps.Metro.Styles.CheckBox}"/>
                    <CheckBox x:Name="cbNotificationsEnabled" Content="Habilitar notificaciones" 
                              IsChecked="{Binding NotificationsEnabled}" Checked="Setting_Changed" Unchecked="Setting_Changed"
                              Style="{DynamicResource MahApps.Metro.Styles.CheckBox}"/>
                    <CheckBox x:Name="cbDisconnectWiimotesOnDolphin" Content="Desconectar Wiimotes al iniciar Dolphin" 
                              IsChecked="{Binding DisconnectWiimotesOnDolphin}" Checked="Setting_Changed" Unchecked="Setting_Changed"
                              Style="{DynamicResource MahApps.Metro.Styles.CheckBox}"/>
                    <CheckBox x:Name="cbNoTopmost" Content="No mantener la ventana siempre encima" 
                              IsChecked="{Binding NoTopmost}" Checked="Setting_Changed" Unchecked="Setting_Changed"
                              Style="{DynamicResource MahApps.Metro.Styles.CheckBox}"/>

                    <Grid Margin="0,5,0,0">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <Label Grid.Column="0" Content="Monitor Principal:"/>
                        <TextBox Grid.Column="1" Text="{Binding PrimaryMonitor}" LostFocus="TextBox_LostFocus"
                                 Style="{DynamicResource MahApps.Metro.Styles.TextBox}"/>
                    </Grid>
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <Label Grid.Column="0" Content="Ruta de Dolphin:"/>
                        <TextBox Grid.Column="1" Text="{Binding DolphinPath}" LostFocus="TextBox_LostFocus"
                                 Style="{DynamicResource MahApps.Metro.Styles.TextBox}" Margin="5,0,0,0"/>
                        <Button Grid.Column="1" Content="..." Width="30" Height="30" Margin="417,0,0,0"
                                Click="BtnBrowseDolphinPath_Click"
                                Style="{DynamicResource AccentedSquareButtonStyle}"/>
                    </Grid>
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <Label Grid.Column="0" Content="Ruta de Keymaps:"/>
                        <TextBox Grid.Column="1" Text="{Binding KeymapsPath}" LostFocus="TextBox_LostFocus"
                                 Style="{DynamicResource MahApps.Metro.Styles.TextBox}"/>
                        <Button Grid.Column="1" Content="..." Width="30" Height="30" Margin="412,0,0,0"
                                Click="BtnBrowseKeyMapsPath_Click"
                                Style="{DynamicResource AccentedSquareButtonStyle}"/>
                    </Grid>
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <Label Grid.Column="0" Content="Configuración de Keymaps:"/>
                        <TextBox Grid.Column="1" Text="{Binding KeymapsConfig}" LostFocus="TextBox_LostFocus"
                                 Style="{DynamicResource MahApps.Metro.Styles.TextBox}"/>
                        <!-- Botón para buscar el archivo Keymaps.json -->
                        <Button Grid.Column="1" Content="..." Width="30" Height="30" Margin="362,0,0,0"
                                Click="BtnBrowseKeymapsConfig_Click"
                                Style="{DynamicResource AccentedSquareButtonStyle}"/>
                    </Grid>

                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <Label Grid.Column="0" Content="Tiempo de desconexión automática (ms):"/>
                        <TextBox Grid.Column="1" Text="{Binding AutoDisconnectTimeout, StringFormat={}{0:N0}}" LostFocus="TextBox_LostFocus" PreviewTextInput="NumericTextBox_PreviewTextInput"
                                 Style="{DynamicResource MahApps.Metro.Styles.TextBox}"/>
                    </Grid>
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <Label Grid.Column="0" Content="Escala continua predeterminada:"/>
                        <Slider Grid.Column="1" Value="{Binding DefaultContinousScale}" Minimum="0.0" Maximum="2.0" SmallChange="0.01" LargeChange="0.1" TickPlacement="BottomRight" IsSnapToTickEnabled="False" ValueChanged="Slider_ValueChanged"
                                Style="{DynamicResource MahApps.Metro.Styles.Slider}"/>
                        <TextBox Grid.Column="1" Text="{Binding DefaultContinousScale, StringFormat={}{0:F2}}" Width="50" HorizontalAlignment="Right" LostFocus="TextBox_LostFocus" PreviewTextInput="DoubleTextBox_PreviewTextInput"
                                 Style="{DynamicResource MahApps.Metro.Styles.TextBox}"/>
                    </Grid>
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <Label Grid.Column="0" Content="Umbral de pulsación continua predeterminado:"/>
                        <Slider Grid.Column="1" Value="{Binding DefaultContinousPressThreshold}" Minimum="0.0" Maximum="1.0" SmallChange="0.01" LargeChange="0.1" TickPlacement="BottomRight" IsSnapToTickEnabled="False" ValueChanged="Slider_ValueChanged"
                                Style="{DynamicResource MahApps.Metro.Styles.Slider}"/>
                        <TextBox Grid.Column="1" Text="{Binding DefaultContinousPressThreshold, StringFormat={}{0:F2}}" Width="50" HorizontalAlignment="Right" LostFocus="TextBox_LostFocus" PreviewTextInput="DoubleTextBox_PreviewTextInput"
                                 Style="{DynamicResource MahApps.Metro.Styles.TextBox}"/>
                    </Grid>
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <Label Grid.Column="0" Content="Zona muerta continua predeterminada:"/>
                        <Slider Grid.Column="1" Value="{Binding DefaultContinousDeadzone}" Minimum="0.0" Maximum="0.1" SmallChange="0.001" LargeChange="0.01" TickPlacement="BottomRight" IsSnapToTickEnabled="False" ValueChanged="Slider_ValueChanged"
                                Style="{DynamicResource MahApps.Metro.Styles.Slider}"/>
                        <TextBox Grid.Column="1" Text="{Binding DefaultContinousDeadzone, StringFormat={}{0:F3}}" Width="50" HorizontalAlignment="Right" LostFocus="TextBox_LostFocus" PreviewTextInput="DoubleTextBox_PreviewTextInput"
                                 Style="{DynamicResource MahApps.Metro.Styles.TextBox}"/>
                    </Grid>
                </StackPanel>
            </GroupBox>

            <!-- Pointer Settings -->
            <GroupBox Header="Configuración del Puntero" Margin="0,10,0,0"
                      Style="{DynamicResource MahApps.Metro.Styles.GroupBox}">
                <StackPanel Margin="5">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <Label Grid.Column="0" Content="Compensación de posición de la barra sensora:"/>
                        <Slider Grid.Column="1" Value="{Binding PointerSensorBarPosCompensation}" Minimum="0.0" Maximum="1.0" SmallChange="0.01" LargeChange="0.1" ValueChanged="Slider_ValueChanged"
                                Style="{DynamicResource MahApps.Metro.Styles.Slider}"/>
                        <TextBox Grid.Column="1" Text="{Binding PointerSensorBarPosCompensation, StringFormat={}{0:F2}}" Width="50" HorizontalAlignment="Right" LostFocus="TextBox_LostFocus" PreviewTextInput="DoubleTextBox_PreviewTextInput"
                                 Style="{DynamicResource MahApps.Metro.Styles.TextBox}"/>
                    </Grid>
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <Label Grid.Column="0" Content="Tamaño del cursor del puntero:"/>
                        <Slider Grid.Column="1" Value="{Binding PointerCursorSize}" Minimum="0.01" Maximum="0.1" SmallChange="0.001" LargeChange="0.01" ValueChanged="Slider_ValueChanged"
                                Style="{DynamicResource MahApps.Metro.Styles.Slider}"/>
                        <TextBox Grid.Column="1" Text="{Binding PointerCursorSize, StringFormat={}{0:F3}}" Width="50" HorizontalAlignment="Right" LostFocus="TextBox_LostFocus" PreviewTextInput="DoubleTextBox_PreviewTextInput"
                                 Style="{DynamicResource MahApps.Metro.Styles.TextBox}"/>
                    </Grid>
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <Label Grid.Column="0" Content="Márgenes superior/inferior del puntero:"/>
                        <Slider Grid.Column="1" Value="{Binding PointerMarginsTopBottom}" Minimum="0.0" Maximum="1.0" SmallChange="0.01" LargeChange="0.1" ValueChanged="Slider_ValueChanged"
                                Style="{DynamicResource MahApps.Metro.Styles.Slider}"/>
                        <TextBox Grid.Column="1" Text="{Binding PointerMarginsTopBottom, StringFormat={}{0:F2}}" Width="50" HorizontalAlignment="Right" LostFocus="TextBox_LostFocus" PreviewTextInput="DoubleTextBox_PreviewTextInput"
                                 Style="{DynamicResource MahApps.Metro.Styles.TextBox}"/>
                    </Grid>
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <Label Grid.Column="0" Content="Márgenes izquierdo/derecho del puntero:"/>
                        <Slider Grid.Column="1" Value="{Binding PointerMarginsLeftRight}" Minimum="0.0" Maximum="1.0" SmallChange="0.01" LargeChange="0.1" ValueChanged="Slider_ValueChanged"
                                Style="{DynamicResource MahApps.Metro.Styles.Slider}"/>
                        <TextBox Grid.Column="1" Text="{Binding PointerMarginsLeftRight, StringFormat={}{0:F2}}" Width="50" HorizontalAlignment="Right" LostFocus="TextBox_LostFocus" PreviewTextInput="DoubleTextBox_PreviewTextInput"
                                 Style="{DynamicResource MahApps.Metro.Styles.TextBox}"/>
                    </Grid>
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <Label Grid.Column="0" Content="FPS del puntero:"/>
                        <Slider Grid.Column="1" Value="{Binding PointerFPS}" Minimum="1" Maximum="200" SmallChange="1" LargeChange="10" ValueChanged="Slider_ValueChanged"
                                Style="{DynamicResource MahApps.Metro.Styles.Slider}"/>
                        <TextBox Grid.Column="1" Text="{Binding PointerFPS, StringFormat={}{0:N0}}" Width="50" HorizontalAlignment="Right" LostFocus="TextBox_LostFocus" PreviewTextInput="NumericTextBox_PreviewTextInput"
                                 Style="{DynamicResource MahApps.Metro.Styles.TextBox}"/>
                    </Grid>
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <Label Grid.Column="0" Content="Suavizado de posición del puntero:"/>
                        <Slider Grid.Column="1" Value="{Binding PointerPositionSmoothing}" Minimum="0" Maximum="10" SmallChange="1" LargeChange="1" ValueChanged="Slider_ValueChanged"
                                Style="{DynamicResource MahApps.Metro.Styles.Slider}"/>
                        <TextBox Grid.Column="1" Text="{Binding PointerPositionSmoothing, StringFormat={}{0:N0}}" Width="50" HorizontalAlignment="Right" LostFocus="TextBox_LostFocus" PreviewTextInput="NumericTextBox_PreviewTextInput"
                                 Style="{DynamicResource MahApps.Metro.Styles.TextBox}"/>
                    </Grid>
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <Label Grid.Column="0" Content="Radio de posición del puntero:"/>
                        <Slider Grid.Column="1" Value="{Binding PointerPositionRadius}" Minimum="0.0" Maximum="0.01" SmallChange="0.0001" LargeChange="0.001" ValueChanged="Slider_ValueChanged"
                                Style="{DynamicResource MahApps.Metro.Styles.Slider}"/>
                        <TextBox Grid.Column="1" Text="{Binding PointerPositionRadius, StringFormat={}{0:F4}}" Width="50" HorizontalAlignment="Right" LostFocus="TextBox_LostFocus" PreviewTextInput="DoubleTextBox_PreviewTextInput"
                                 Style="{DynamicResource MahApps.Metro.Styles.TextBox}"/>
                    </Grid>
                </StackPanel>
            </GroupBox>

            <!-- Test Settings -->
            <GroupBox Header="Configuración de Prueba" Margin="0,10,0,0"
                      Style="{DynamicResource MahApps.Metro.Styles.GroupBox}">
                <StackPanel Margin="5">
                    <CheckBox x:Name="cbTestDeltaAccel" Content="Habilitar aceleración delta de prueba" 
                              IsChecked="{Binding TestDeltaAccel}" Checked="Setting_Changed" Unchecked="Setting_Changed"
                              Style="{DynamicResource MahApps.Metro.Styles.CheckBox}"/>
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <Label Grid.Column="0" Content="Multiplicador de aceleración delta de prueba:"/>
                        <Slider Grid.Column="1" Value="{Binding TestDeltaAccelMulti}" Minimum="0.0" Maximum="10.0" SmallChange="0.1" LargeChange="1.0" ValueChanged="Slider_ValueChanged"
                                Style="{DynamicResource MahApps.Metro.Styles.Slider}"/>
                        <TextBox Grid.Column="1" Text="{Binding TestDeltaAccelMulti, StringFormat={}{0:F1}}" Width="50" HorizontalAlignment="Right" LostFocus="TextBox_LostFocus" PreviewTextInput="DoubleTextBox_PreviewTextInput"
                                 Style="{DynamicResource MahApps.Metro.Styles.TextBox}"/>
                    </Grid>
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <Label Grid.Column="0" Content="Recorrido mínimo de aceleración delta de prueba:"/>
                        <Slider Grid.Column="1" Value="{Binding TestDeltaAccelMinTravel}" Minimum="0.0" Maximum="0.1" SmallChange="0.001" LargeChange="0.01" ValueChanged="Slider_ValueChanged"
                                Style="{DynamicResource MahApps.Metro.Styles.Slider}"/>
                        <TextBox Grid.Column="1" Text="{Binding TestDeltaAccelMinTravel, StringFormat={}{0:F3}}" Width="50" HorizontalAlignment="Right" LostFocus="TextBox_LostFocus" PreviewTextInput="DoubleTextBox_PreviewTextInput"
                                 Style="{DynamicResource MahApps.Metro.Styles.TextBox}"/>
                    </Grid>
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <Label Grid.Column="0" Content="Duración de suavizado de aceleración delta de prueba:"/>
                        <Slider Grid.Column="1" Value="{Binding TestDeltaAccelEasingDuration}" Minimum="0.0" Maximum="1.0" SmallChange="0.01" LargeChange="0.1" ValueChanged="Slider_ValueChanged"
                                Style="{DynamicResource MahApps.Metro.Styles.Slider}"/>
                        <TextBox Grid.Column="1" Text="{Binding TestDeltaAccelEasingDuration, StringFormat={}{0:F2}}" Width="50" HorizontalAlignment="Right" LostFocus="TextBox_LostFocus" PreviewTextInput="DoubleTextBox_PreviewTextInput"
                                 Style="{DynamicResource MahApps.Metro.Styles.TextBox}"/>
                    </Grid>
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <Label Grid.Column="0" Content="Duración de suavizado de región X de prueba:"/>
                        <Slider Grid.Column="1" Value="{Binding TestRegionEasingXDuration}" Minimum="0.0" Maximum="1.0" SmallChange="0.01" LargeChange="0.1" ValueChanged="Slider_ValueChanged"
                                Style="{DynamicResource MahApps.Metro.Styles.Slider}"/>
                        <TextBox Grid.Column="1" Text="{Binding TestRegionEasingXDuration, StringFormat={}{0:F2}}" Width="50" HorizontalAlignment="Right" LostFocus="TextBox_LostFocus" PreviewTextInput="DoubleTextBox_PreviewTextInput"
                                 Style="{DynamicResource MahApps.Metro.Styles.TextBox}"/>
                    </Grid>
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <Label Grid.Column="0" Content="Recorrido máximo de aceleración delta de prueba:"/>
                        <Slider Grid.Column="1" Value="{Binding TestDeltaAccelMaxTravel}" Minimum="0.0" Maximum="1.0" SmallChange="0.001" LargeChange="0.01" ValueChanged="Slider_ValueChanged"
                                Style="{DynamicResource MahApps.Metro.Styles.Slider}"/>
                        <TextBox Grid.Column="1" Text="{Binding TestDeltaAccelMaxTravel, StringFormat={}{0:F3}}" Width="50" HorizontalAlignment="Right" LostFocus="TextBox_LostFocus" PreviewTextInput="DoubleTextBox_PreviewTextInput"
                                 Style="{DynamicResource MahApps.Metro.Styles.TextBox}"/>
                    </Grid>
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <Label Grid.Column="0" Content="Desplazamiento de región X de prueba:"/>
                        <Slider Grid.Column="1" Value="{Binding TestRegionEasingXOffset}" Minimum="0.0" Maximum="1.0" SmallChange="0.01" LargeChange="0.1" ValueChanged="Slider_ValueChanged"
                                Style="{DynamicResource MahApps.Metro.Styles.Slider}"/>
                        <TextBox Grid.Column="1" Text="{Binding TestRegionEasingXOffset, StringFormat={}{0:F2}}" Width="50" HorizontalAlignment="Right" LostFocus="TextBox_LostFocus" PreviewTextInput="DoubleTextBox_PreviewTextInput"
                                 Style="{DynamicResource MahApps.Metro.Styles.TextBox}"/>
                    </Grid>
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <Label Grid.Column="0" Content="Peso de suavizado de prueba:"/>
                        <Slider Grid.Column="1" Value="{Binding TestSmoothingWeight}" Minimum="0.0" Maximum="1.0" SmallChange="0.01" LargeChange="0.1" ValueChanged="Slider_ValueChanged"
                                Style="{DynamicResource MahApps.Metro.Styles.Slider}"/>
                        <TextBox Grid.Column="1" Text="{Binding TestSmoothingWeight, StringFormat={}{0:F2}}" Width="50" HorizontalAlignment="Right" LostFocus="TextBox_LostFocus" PreviewTextInput="DoubleTextBox_PreviewTextInput"
                                 Style="{DynamicResource MahApps.Metro.Styles.TextBox}"/>
                    </Grid>
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <Label Grid.Column="0" Content="Desplazamiento del ratón FPS de prueba:"/>
                        <Slider Grid.Column="1" Value="{Binding TestFpsmouseOffset}" Minimum="0.0" Maximum="1.0" SmallChange="0.01" LargeChange="0.1" ValueChanged="Slider_ValueChanged"
                                Style="{DynamicResource MahApps.Metro.Styles.Slider}"/>
                        <TextBox Grid.Column="1" Text="{Binding TestFpsmouseOffset, StringFormat={}{0:F2}}" Width="50" HorizontalAlignment="Right" LostFocus="TextBox_LostFocus" PreviewTextInput="DoubleTextBox_PreviewTextInput"
                                 Style="{DynamicResource MahApps.Metro.Styles.TextBox}"/>
                    </Grid>
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <Label Grid.Column="0" Content="Margen de calibración X:"/>
                        <Slider Grid.Column="1" Value="{Binding CalibrationMarginX}" Minimum="0.0" Maximum="1.0" SmallChange="0.01" LargeChange="0.1" ValueChanged="Slider_ValueChanged"
                                Style="{DynamicResource MahApps.Metro.Styles.Slider}"/>
                        <TextBox Grid.Column="1" Text="{Binding CalibrationMarginX, StringFormat={}{0:F2}}" Width="50" HorizontalAlignment="Right" LostFocus="TextBox_LostFocus" PreviewTextInput="DoubleTextBox_PreviewTextInput"
                                 Style="{DynamicResource MahApps.Metro.Styles.TextBox}"/>
                    </Grid>
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <Label Grid.Column="0" Content="Margen de calibración Y:"/>
                        <Slider Grid.Column="1" Value="{Binding CalibrationMarginY}" Minimum="0.0" Maximum="1.0" SmallChange="0.01" LargeChange="0.1" ValueChanged="Slider_ValueChanged"
                                Style="{DynamicResource MahApps.Metro.Styles.Slider}"/>
                        <TextBox Grid.Column="1" Text="{Binding CalibrationMarginY, StringFormat={}{0:F2}}" Width="50" HorizontalAlignment="Right" LostFocus="TextBox_LostFocus" PreviewTextInput="DoubleTextBox_PreviewTextInput"
                                 Style="{DynamicResource MahApps.Metro.Styles.TextBox}"/>
                    </Grid>
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <Label Grid.Column="0" Content="Recorte mínimo de One Euro de pistola de luz:"/>
                        <Slider Grid.Column="1" Value="{Binding TestLightgunOneeuroMincutoff}" Minimum="0.0" Maximum="10.0" SmallChange="0.1" LargeChange="1.0" ValueChanged="Slider_ValueChanged"
                                Style="{DynamicResource MahApps.Metro.Styles.Slider}"/>
                        <TextBox Grid.Column="1" Text="{Binding TestLightgunOneeuroMincutoff, StringFormat={}{0:F1}}" Width="50" HorizontalAlignment="Right" LostFocus="TextBox_LostFocus" PreviewTextInput="DoubleTextBox_PreviewTextInput"
                                 Style="{DynamicResource MahApps.Metro.Styles.TextBox}"/>
                    </Grid>
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <Label Grid.Column="0" Content="Beta de One Euro de pistola de luz:"/>
                        <Slider Grid.Column="1" Value="{Binding TestLightgunOneeuroBeta}" Minimum="0.0" Maximum="1.0" SmallChange="0.01" LargeChange="0.1" ValueChanged="Slider_ValueChanged"
                                Style="{DynamicResource MahApps.Metro.Styles.Slider}"/>
                        <TextBox Grid.Column="1" Text="{Binding TestLightgunOneeuroBeta, StringFormat={}{0:F2}}" Width="50" HorizontalAlignment="Right" LostFocus="TextBox_LostFocus" PreviewTextInput="DoubleTextBox_PreviewTextInput"
                                 Style="{DynamicResource MahApps.Metro.Styles.TextBox}"/>
                    </Grid>
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <Label Grid.Column="0" Content="Zona muerta del ratón FPS:"/>
                        <Slider Grid.Column="1" Value="{Binding FpsmouseDeadzone}" Minimum="0.0" Maximum="0.1" SmallChange="0.001" LargeChange="0.01" ValueChanged="Slider_ValueChanged"
                                Style="{DynamicResource MahApps.Metro.Styles.Slider}"/>
                        <TextBox Grid.Column="1" Text="{Binding FpsmouseDeadzone, StringFormat={}{0:F3}}" Width="50" HorizontalAlignment="Right" LostFocus="TextBox_LostFocus" PreviewTextInput="DoubleTextBox_PreviewTextInput"
                                 Style="{DynamicResource MahApps.Metro.Styles.TextBox}"/>
                    </Grid>
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <Label Grid.Column="0" Content="Velocidad del ratón FPS:"/>
                        <Slider Grid.Column="1" Value="{Binding FpsmouseSpeed}" Minimum="1" Maximum="100" SmallChange="1" LargeChange="10" ValueChanged="Slider_ValueChanged"
                                Style="{DynamicResource MahApps.Metro.Styles.Slider}"/>
                        <TextBox Grid.Column="1" Text="{Binding FpsmouseSpeed, StringFormat={}{0:N0}}" Width="50" HorizontalAlignment="Right" LostFocus="TextBox_LostFocus" PreviewTextInput="NumericTextBox_PreviewTextInput"
                                 Style="{DynamicResource MahApps.Metro.Styles.TextBox}"/>
                    </Grid>
                </StackPanel>
            </GroupBox>

            <!-- Shake Settings -->
            <GroupBox Header="Configuración de Agitación" Margin="0,10,0,0"
                      Style="{DynamicResource MahApps.Metro.Styles.GroupBox}">
                <StackPanel Margin="5">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <Label Grid.Column="0" Content="Umbral de agitación:"/>
                        <Slider Grid.Column="1" Value="{Binding ShakeThreshold}" Minimum="0.0" Maximum="1.0" SmallChange="0.01" LargeChange="0.1" ValueChanged="Slider_ValueChanged"
                                Style="{DynamicResource MahApps.Metro.Styles.Slider}"/>
                        <TextBox Grid.Column="1" Text="{Binding ShakeThreshold, StringFormat={}{0:F2}}" Width="50" HorizontalAlignment="Right" LostFocus="TextBox_LostFocus" PreviewTextInput="DoubleTextBox_PreviewTextInput"
                                 Style="{DynamicResource MahApps.Metro.Styles.TextBox}"/>
                    </Grid>
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <Label Grid.Column="0" Content="Conteo de agitación:"/>
                        <Slider Grid.Column="1" Value="{Binding ShakeCount}" Minimum="1" Maximum="10" SmallChange="1" LargeChange="1" ValueChanged="Slider_ValueChanged"
                                Style="{DynamicResource MahApps.Metro.Styles.Slider}"/>
                        <TextBox Grid.Column="1" Text="{Binding ShakeCount, StringFormat={}{0:N0}}" Width="50" HorizontalAlignment="Right" LostFocus="TextBox_LostFocus" PreviewTextInput="NumericTextBox_PreviewTextInput"
                                 Style="{DynamicResource MahApps.Metro.Styles.TextBox}"/>
                    </Grid>
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <Label Grid.Column="0" Content="Tiempo máximo entre agitaciones (ms):"/>
                        <Slider Grid.Column="1" Value="{Binding ShakeMaxTimeInBetween}" Minimum="0" Maximum="1000" SmallChange="10" LargeChange="100" ValueChanged="Slider_ValueChanged"
                                Style="{DynamicResource MahApps.Metro.Styles.Slider}"/>
                        <TextBox Grid.Column="1" Text="{Binding ShakeMaxTimeInBetween, StringFormat={}{0:N0}}" Width="50" HorizontalAlignment="Right" LostFocus="TextBox_LostFocus" PreviewTextInput="NumericTextBox_PreviewTextInput"
                                 Style="{DynamicResource MahApps.Metro.Styles.TextBox}"/>
                    </Grid>
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <Label Grid.Column="0" Content="Tiempo de pulsación de agitación (ms):"/>
                        <Slider Grid.Column="1" Value="{Binding ShakePressedTime}" Minimum="0" Maximum="1000" SmallChange="10" LargeChange="100" ValueChanged="Slider_ValueChanged"
                                Style="{DynamicResource MahApps.Metro.Styles.Slider}"/>
                        <TextBox Grid.Column="1" Text="{Binding ShakePressedTime, StringFormat={}{0:N0}}" Width="50" HorizontalAlignment="Right" LostFocus="TextBox_LostFocus" PreviewTextInput="NumericTextBox_PreviewTextInput"
                                 Style="{DynamicResource MahApps.Metro.Styles.TextBox}"/>
                    </Grid>
                </StackPanel>
            </GroupBox>

            <!-- XInput Rumble Settings -->
            <GroupBox Header="Configuración de Vibración XInput" Margin="0,10,0,0"
                      Style="{DynamicResource MahApps.Metro.Styles.GroupBox}">
                <StackPanel Margin="5">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <Label Grid.Column="0" Content="Umbral de vibración grande XInput:"/>
                        <Slider Grid.Column="1" Value="{Binding XinputRumbleThresholdBig}" Minimum="0" Maximum="255" SmallChange="1" LargeChange="10" ValueChanged="Slider_ValueChanged"
                                Style="{DynamicResource MahApps.Metro.Styles.Slider}"/>
                        <TextBox Grid.Column="1" Text="{Binding XinputRumbleThresholdBig, StringFormat={}{0:N0}}" Width="50" HorizontalAlignment="Right" LostFocus="TextBox_LostFocus" PreviewTextInput="NumericTextBox_PreviewTextInput"
                                 Style="{DynamicResource MahApps.Metro.Styles.TextBox}"/>
                    </Grid>
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <Label Grid.Column="0" Content="Umbral de vibración pequeña XInput:"/>
                        <Slider Grid.Column="1" Value="{Binding XinputRumbleThresholdSmall}" Minimum="0" Maximum="255" SmallChange="1" LargeChange="10" ValueChanged="Slider_ValueChanged"
                                Style="{DynamicResource MahApps.Metro.Styles.Slider}"/>
                        <TextBox Grid.Column="1" Text="{Binding XinputRumbleThresholdSmall, StringFormat={}{0:N0}}" Width="50" HorizontalAlignment="Right" LostFocus="TextBox_LostFocus" PreviewTextInput="NumericTextBox_PreviewTextInput"
                                 Style="{DynamicResource MahApps.Metro.Styles.TextBox}"/>
                    </Grid>
                </StackPanel>
            </GroupBox>

            <!-- Wiimode Rumble & Sound Settings -->
            <GroupBox Header="Configuración de Vibración y Sonido Wiimote" Margin="0,10,0,0"
                      Style="{DynamicResource MahApps.Metro.Styles.GroupBox}">
                <StackPanel Margin="5">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <Label Grid.Column="0" Content="Tiempo de vibración corta del Wiimote (ms):"/>
                        <Slider Grid.Column="1" Value="{Binding WiimodeRumbleTimeShort}" Minimum="0" Maximum="1000" SmallChange="10" LargeChange="100" ValueChanged="Slider_ValueChanged"
                                Style="{DynamicResource MahApps.Metro.Styles.Slider}"/>
                        <TextBox Grid.Column="1" Text="{Binding WiimodeRumbleTimeShort, StringFormat={}{0:N0}}" Width="50" HorizontalAlignment="Right" LostFocus="TextBox_LostFocus" PreviewTextInput="NumericTextBox_PreviewTextInput"
                                 Style="{DynamicResource MahApps.Metro.Styles.TextBox}"/>
                    </Grid>
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <Label Grid.Column="0" Content="Tiempo de vibración larga del Wiimote (ms):"/>
                        <Slider Grid.Column="1" Value="{Binding WiimodeRumbleTimeLong}" Minimum="0" Maximum="1000" SmallChange="10" LargeChange="100" ValueChanged="Slider_ValueChanged"
                                Style="{DynamicResource MahApps.Metro.Styles.Slider}"/>
                        <TextBox Grid.Column="1" Text="{Binding WiimodeRumbleTimeLong, StringFormat={}{0:N0}}" Width="50" HorizontalAlignment="Right" LostFocus="TextBox_LostFocus" PreviewTextInput="NumericTextBox_PreviewTextInput"
                                 Style="{DynamicResource MahApps.Metro.Styles.TextBox}"/>
                    </Grid>
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <Label Grid.Column="0" Content="Tiempo de vibración alternante ON (ms):"/>
                        <Slider Grid.Column="1" Value="{Binding WiimodeRumbleTimeAlternatingOn}" Minimum="0" Maximum="500" SmallChange="10" LargeChange="50" ValueChanged="Slider_ValueChanged"
                                Style="{DynamicResource MahApps.Metro.Styles.Slider}"/>
                        <TextBox Grid.Column="1" Text="{Binding WiimodeRumbleTimeAlternatingOn, StringFormat={}{0:N0}}" Width="50" HorizontalAlignment="Right" LostFocus="TextBox_LostFocus" PreviewTextInput="NumericTextBox_PreviewTextInput"
                                 Style="{DynamicResource MahApps.Metro.Styles.TextBox}"/>
                    </Grid>
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <Label Grid.Column="0" Content="Tiempo de vibración alternante OFF (ms):"/>
                        <Slider Grid.Column="1" Value="{Binding WiimodeRumbleTimeAlternatingOff}" Minimum="0" Maximum="500" SmallChange="10" LargeChange="50" ValueChanged="Slider_ValueChanged"
                                Style="{DynamicResource MahApps.Metro.Styles.Slider}"/>
                        <TextBox Grid.Column="1" Text="{Binding WiimodeRumbleTimeAlternatingOff, StringFormat={}{0:N0}}" Width="50" HorizontalAlignment="Right" LostFocus="TextBox_LostFocus" PreviewTextInput="NumericTextBox_PreviewTextInput"
                                 Style="{DynamicResource MahApps.Metro.Styles.TextBox}"/>
                    </Grid>
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <Label Grid.Column="0" Content="Tiempo de sonido de bucle del Wiimote (ms):"/>
                        <Slider Grid.Column="1" Value="{Binding WiimodeLoopSoundTime}" Minimum="0" Maximum="1000" SmallChange="10" LargeChange="100" ValueChanged="Slider_ValueChanged"
                                Style="{DynamicResource MahApps.Metro.Styles.Slider}"/>
                        <TextBox Grid.Column="1" Text="{Binding WiimodeLoopSoundTime, StringFormat={}{0:N0}}" Width="50" HorizontalAlignment="Right" LostFocus="TextBox_LostFocus" PreviewTextInput="NumericTextBox_PreviewTextInput"
                                 Style="{DynamicResource MahApps.Metro.Styles.TextBox}"/>
                    </Grid>
                </StackPanel>
            </GroupBox>

            <!-- Color ID Settings -->
            <GroupBox Header="Configuración de Colores de ID" Margin="0,10,0,0"
                      Style="{DynamicResource MahApps.Metro.Styles.GroupBox}">
                <StackPanel Margin="5">
                    <Label Content="Color ID 1 (R, G, B):" Style="{DynamicResource MahApps.Metro.Styles.Label}" FontWeight="Normal"/>
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <TextBox Grid.Column="0" Text="{Binding ColorID1[0]}" LostFocus="ColorTextBox_LostFocus" Tag="ColorID1_0" PreviewTextInput="NumericTextBox_PreviewTextInput"
                                 Style="{DynamicResource MahApps.Metro.Styles.TextBox}"/>
                        <TextBox Grid.Column="1" Text="{Binding ColorID1[1]}" LostFocus="ColorTextBox_LostFocus" Tag="ColorID1_1" PreviewTextInput="NumericTextBox_PreviewTextInput"
                                 Style="{DynamicResource MahApps.Metro.Styles.TextBox}"/>
                        <TextBox Grid.Column="2" Text="{Binding ColorID1[2]}" LostFocus="ColorTextBox_LostFocus" Tag="ColorID1_2" PreviewTextInput="NumericTextBox_PreviewTextInput"
                                 Style="{DynamicResource MahApps.Metro.Styles.TextBox}"/>
                    </Grid>
                    <Label Content="Color ID 2 (R, G, B):" Style="{DynamicResource MahApps.Metro.Styles.Label}" FontWeight="Normal"/>
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <TextBox Grid.Column="0" Text="{Binding ColorID2[0]}" LostFocus="ColorTextBox_LostFocus" Tag="ColorID2_0" PreviewTextInput="NumericTextBox_PreviewTextInput"
                                 Style="{DynamicResource MahApps.Metro.Styles.TextBox}"/>
                        <TextBox Grid.Column="1" Text="{Binding ColorID2[1]}" LostFocus="ColorTextBox_LostFocus" Tag="ColorID2_1" PreviewTextInput="NumericTextBox_PreviewTextInput"
                                 Style="{DynamicResource MahApps.Metro.Styles.TextBox}"/>
                        <TextBox Grid.Column="2" Text="{Binding ColorID2[2]}" LostFocus="ColorTextBox_LostFocus" Tag="ColorID2_2" PreviewTextInput="NumericTextBox_PreviewTextInput"
                                 Style="{DynamicResource MahApps.Metro.Styles.TextBox}"/>
                    </Grid>
                    <Label Content="Color ID 3 (R, G, B):" Style="{DynamicResource MahApps.Metro.Styles.Label}" FontWeight="Normal"/>
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <TextBox Grid.Column="0" Text="{Binding ColorID3[0]}" LostFocus="ColorTextBox_LostFocus" Tag="ColorID3_0" PreviewTextInput="NumericTextBox_PreviewTextInput"
                                 Style="{DynamicResource MahApps.Metro.Styles.TextBox}"/>
                        <TextBox Grid.Column="1" Text="{Binding ColorID3[1]}" LostFocus="ColorTextBox_LostFocus" Tag="ColorID3_1" PreviewTextInput="NumericTextBox_PreviewTextInput"
                                 Style="{DynamicResource MahApps.Metro.Styles.TextBox}"/>
                        <TextBox Grid.Column="2" Text="{Binding ColorID3[2]}" LostFocus="ColorTextBox_LostFocus" Tag="ColorID3_2" PreviewTextInput="NumericTextBox_PreviewTextInput"
                                 Style="{DynamicResource MahApps.Metro.Styles.TextBox}"/>
                    </Grid>
                    <Label Content="Color ID 4 (R, G, B):" Style="{DynamicResource MahApps.Metro.Styles.Label}" FontWeight="Normal"/>
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <TextBox Grid.Column="0" Text="{Binding ColorID4[0]}" LostFocus="ColorTextBox_LostFocus" Tag="ColorID4_0" PreviewTextInput="NumericTextBox_PreviewTextInput"
                                 Style="{DynamicResource MahApps.Metro.Styles.TextBox}"/>
                        <TextBox Grid.Column="1" Text="{Binding ColorID4[1]}" LostFocus="ColorTextBox_LostFocus" Tag="ColorID4_1" PreviewTextInput="NumericTextBox_PreviewTextInput"
                                 Style="{DynamicResource MahApps.Metro.Styles.TextBox}"/>
                        <TextBox Grid.Column="2" Text="{Binding ColorID4[2]}" LostFocus="ColorTextBox_LostFocus" Tag="ColorID4_2" PreviewTextInput="NumericTextBox_PreviewTextInput"
                                 Style="{DynamicResource MahApps.Metro.Styles.TextBox}"/>
                    </Grid>
                </StackPanel>
            </GroupBox>
        </StackPanel>
    </ScrollViewer>
</Controls:MetroWindow>
